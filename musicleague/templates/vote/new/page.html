{% extends "base.html" %}

{% block title %}Music League | {{ league.name }}{% endblock %}

{% block css %}
<link rel="stylesheet" href="/static/css/vote.css">
{% endblock %}

{% block content %}

<div id="img-bar" style="background-image: url('/static/images/{{ user.profile_background }}')">
    <div id="nav-bar">
        <div class="brand-wrapper">
            <a href="/">
                <img src="/static/icons/site_logo.svg" alt="" class="brand-icon">
            </a>
        </div>
        <div class="add-league-wrapper">
            <span class="add-league-text hidden-xs">Add League</span>
            <a href="{{ url_for('get_create_league') }}">
                <img src="/static/icons/add_icon.svg" alt="" class="add-league-icon">
            </a>
        </div>
        <svg class="account-divider" width="7" height="120" viewBox="0 0 3 120" version="1.1" xmlns="http://www.w3.org/2000/svg">
            <line stroke-linecap="round" x1="1" y1="0" x2="1" y2="90" stroke="white" stroke-width="3"/>
        </svg>
        <div class="account-wrapper">
            <span class="account-name hidden-xs">{{ user.first_name }}</span>
            <div class="dropdown" style="display: inline;">
                <a type="button" class="dropdown-toggle account-icon" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <img src="/static/icons/account_icon.svg" alt="" class="account-icon">
                </a>
                <ul class="dropdown-menu pull-right">
                    <li>
                        <a href="{{ url_for('profile') }}">
                            <span id="profile-icon" class="icon"></span>
                            <span class="text">Profile</span>
                        </a>
                    </li>
                    <li>
                        <a href="{{ url_for('view_profile_settings') }}">
                            <span id="settings-icon" class="icon"></span>
                            <span class="text">Settings</span>
                        </a>
                    </li>
                    <li>
                        <a href="{{ url_for('logout') }}">
                            <span id="logout-icon" class="icon"></span>
                            <span class="text">Log Out</span>
                        </a>
                    </li>
                    {% if user.is_admin %}
                    <li>
                        <a href="{{ url_for('admin') }}">
                            <span id="admin-icon" class="icon"></span>
                            <span class="text">Admin</span>
                        </a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </div>
    <div id="title-bar">
        <span class="round-title">{{ round.name }}:&nbsp;</span>
        <span class="round-action">Voting</span>
        <span class="league-title">{{ league.name }}</span>
    </div>
</div>
<form method="post">
    <div id="status-bar">
        <div class="container">
            <div class="row">
                <div class="hidden-xs col-sm-4 col-md-4 vcenter text-center">
                    <span id="paste-directive">Choose A Song And Add Points To Begin!</span>
                </div><!--
                --><div class="col-xs-6 col-sm-3 col-md-4 vcenter text-center">
                    <span id="progress"><span id="num-spent">00</span> of <span id="max-votes">{{ "%02d" % league.preferences.point_bank_size }}</span></span>
                    <br>
                    <span><span class="hidden-xs">Points </span>Spent</span>
                </div><!--
                --><div class="col-xs-6 col-sm-5 col-md-4 vcenter text-center disabled" id="submit-votes-btn-wrapper">
                    <button type="submit" id="submit-votes-btn" class="btn btn-lg disabled" disabled>Submit<span class="hidden-xs"> Votes</span>!</button>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        {% for uri, song in tracks_by_uri.iteritems() %}
        <div class="song row" data-uri="{{ uri }}" {% if my_vote and uri in my_vote.votes %}data-votes="{{ my_vote.votes[uri] }}"{% endif %}>
            <div class="song-info col-xs-6 col-sm-7 col-md-8">
                <img src="{{ song['album']['images'][1]['url'] }}" alt="" class="img img-rounded hidden-xs">
                <img src="{{ song['album']['images'][1]['url'] }}" alt="" class="img img-rounded visible-xs">
                <div class="text-info hidden-xs">
                    <span class="vcenter name">{{ song['name'] }}</span>
                    <span class="vcenter artist">By {{ song['artists'][0]['name'] }}</span>
                    <span class="vcenter album">{{ song['album']['name'] }}</span>
                </div>
                <div class="text-info visible-xs">
                    <span class="vcenter name">{{ song['name'] }}</span>
                    <span class="vcenter artist">By {{ song['artists'][0]['name'] }}</span>
                    <span class="vcenter album">{{ song['album']['name'] }}</span>
                </div>
            </div>
            <div class="up-down-btn-wrapper col-xs-6 col-sm-5 col-md-4" unselectable="on">
                <span class="down-btn"></span>
                <span class="vote-count">0</span>
                <span class="up-btn"></span>
            </div>
        </div>

        <div class="row">
            <div class="col-xs-12 text-center-xs">
                <svg width="275" height="5" viewBox="0 0 372 7" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <line stroke-linecap="round" x1="0" y1="2" x2="372" y2="2" stroke="#02B8EF" stroke-width="3"/>
                </svg>
            </div>
        </div>

        {% endfor %}
        <input type="hidden" id="votes-inp" name="votes">
    </div>
</form>

{% endblock %}

{% block js %}
<script type="text/javascript" src="/static/js/jquery.sticky-kit.min.js"></script>
<script type="text/javascript" src="/static/js/vote.js"></script>
{% endblock %}
