{% extends "base.html" %}

{% block title %}Music League | {{ submission_period.name }}{% endblock %}

{% block content %}

<div class="container">

    {% include "vote/header.html" %}

    <div class="row">
        <div class="container col-md-8 col-md-offset-2">
            <p class="text-muted">Click songs to add to staging area and vote</p>
            <form action="{{ url_for('vote', league_id=league.id, submission_period_id=submission_period.id) }}" method="post">
                <div class="row">
                    <div class="col-md-6 fade-wrapper">
                        <div id="selection" class="fade-inner">
                        {% for uri, track in tracks_by_uri.iteritems() %}
                            <div class="row track" id="{{ uri }}" style="margin-bottom: 20px; cursor: pointer;" draggable="true" ondragstart="drag(event)">
                                <div class="col-xs-4 col-sm-2">
                                    <img src="{{ track['album']['images'][0]['url'] }}" alt="" class="img img-rounded" width="100%" draggable="false">
                                </div>
                                <div class="col-xs-6 col-sm-8">
                                    <strong>{{ track['name'] }}</strong>
                                    <br>
                                    <span class="text-muted">{{ track['artists'][0]['name'] }}</span>
                                    <br>
                                    <span class="text-muted">{{ track['album']['name'] }}</span>
                                </div>
                                <div class="col-xs-2 col-sm-2 voting-controls" style="display: none; cursor: default">
                                    <div class="text-center" style="border: 1px solid #b7b7b7; border-radius: 5px; padding: 0px 10px">
                                        <div class="text-center">
                                            <i class="fa fa-caret-up vote-up" style="cursor: pointer"></i>
                                        </div>
                                        <div class="text-center vote-count">
                                            {% if my_vote %}{{ my_vote.votes.get(uri) }}{% else %}0{% endif %}
                                        </div>
                                        <div class="text-center">
                                            <i class="fa fa-caret-down vote-down" style="cursor: pointer"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                        </div>
                        <div class="fade-gradient"></div>
                    </div>
                    <div class="col-md-6 fade-wrapper border-left">
                        <div id="staging" class="fade-inner" ondrop="dropStaging(event)" ondragover="allowDrop(event)">
                            {% for uri in tracks_by_uri %}
                            <input type="hidden" name="{{ uri }}" id="{{ uri }}">
                            {% endfor %}
                        </div>
                        <div class="fade-gradient"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="pull-left"><span class="text-muted"><span id="remaining"></span> Votes Left to Give</span></div>
                    <button type="submit" class="btn btn-success">Submit</button>
                    <a href="{{ url_for('view_league', league_id=league.id) }}" class="btn btn-link" id="cancel">Cancel</a>
                </div>
            </form>
        </div>
    </div>

</div>

{% endblock %}

{% block js %}
<script type="text/javascript">
{% include "vote/vote.js" %}
</script>
{% endblock %}
